
<!-- <style>
  .search-btn{
    background-color:#fe424d;
    color: #fff;
    border-radius: 25px;
    padding: 0, 1rem, 0, 1rem;
  }
  .search-btn:hover{
    background-color:#fe424d;
    color: #fff;
  }
  .search-btn i{
    display: inline;
    margin-right: 0.5rem;
  }
  .search-input{
    border-radius: 35px;
    padding: 1rem, 3rem, 1rem, 3rem;
    font-size: 0.8rem;
  }
</style>

<nav class="navbar navbar-expand-lg bg-body-light border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/listings"><i class="fa-regular fa-compass"></i></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav">
        <a class="nav-link" href="/listings">Explore</a>
      </div>
      <div class="navbar-nav ms-auto">
        <form class="d-flex" role="search" id="searchForm">
          <input class="form-control me-2 search-input" type="search" placeholder="Search destinations" id="searchInput" name="query"/>
          <button class="btn search-btn" type="submit"><i class="fa-solid fa-magnifying-glass"></i>Search</button>
        </form>
      </div>
      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="/listings/new">Wanderlust your home</a>
        <% if(currUser) { %>
          <a class="nav-link" href="/bookings">My Bookings</a>
        <% } %>
        <% if(!currUser) { %>
          <a class="nav-link active" href="/signup"><b>SignUp</b></a>
          <a class="nav-link" href="/login"><b>LogIn</b></a>
        <% } %>
        <% if(currUser) { %>
          <a class="nav-link" href="/logout"><b>Logout</b></a>
        <% } %>
      </div>
    </div>
  </div>
</nav>

<script>
  // Search functionality
  const searchForm = document.getElementById('searchForm');
  const searchInput = document.getElementById('searchInput');

  searchForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const query = searchInput.value.trim();
    
    if (!query) {
      window.location.href = '/listings';
      return;
    }

    try {
      const response = await fetch(`/listings/search?query=${encodeURIComponent(query)}`);
      const data = await response.json();
      
      if (data.success) {
        if (window.location.pathname === '/listings') {
          displaySearchResults(data.listings);
        } else {
          sessionStorage.setItem('searchResults', JSON.stringify(data.listings));
          window.location.href = '/listings';
        }
      }
    } catch (error) {
      console.error('Search error:', error);
      alert('Search failed. Please try again.');
    }
  });

  function displaySearchResults(listings) {
    const container = document.getElementById('listings-container');
    
    if (!container) return;

    if (listings.length === 0) {
      container.innerHTML = `
        <div class="col-12 text-center mt-5">
          <h4>No listings found for "${searchInput.value}"</h4>
          <a href="/listings" class="btn btn-primary mt-3">View All Listings</a>
        </div>
      `;
      return;
    }

    const taxSwitch = document.getElementById('switchCheckDefault');
    container.innerHTML = listings.map(listing => `
      <a href="/listings/${listing._id}" class="listing-link">
        <div class="card col listing-card">
          <img src="${listing.image.url}" class="card-img-top" alt="listing_image" style="height: 20rem">
          <div class="card-img-overlay"></div>
          <div class="card-body">
            <p class="card-text">
              <b>${listing.title}</b><br>
              &#8377;${listing.price.toLocaleString("en-IN")} /night
              <i class="tax-info" style="display: ${taxSwitch && taxSwitch.checked ? 'none' : 'inline'}"> &nbsp;+ 18% GST</i>
            </p>
          </div>
        </div>
      </a>
    `).join('');

    
  }

  window.addEventListener('DOMContentLoaded', () => {
    const searchResults = sessionStorage.getItem('searchResults');
    if (searchResults && window.location.pathname === '/listings') {
      const listings = JSON.parse(searchResults);
      displaySearchResults(listings);
      sessionStorage.removeItem('searchResults');
    }
  });
</script> -->







<style>
  /* Original Search Button Styles */
  .search-btn {
    background-color: #fe424d;
    color: #fff;
    border-radius: 25px;
    padding: 0.5rem 1rem;
    border: none;
  }
  .search-btn:hover {
    background-color: #e63946;
    color: #fff;
  }
  .search-btn i {
    display: inline;
    margin-right: 0.5rem;
  }
  .search-input {
    border-radius: 35px;
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
  }

  /* Mobile Navigation Styles */
  .navbar {
    padding: 10px 15px;
  }

  /* Hamburger Menu */
  .hamburger-menu {
    display: none;
    flex-direction: column;
    cursor: pointer;
    z-index: 1001;
    background: none;
    border: none;
    padding: 5px;
  }

  .hamburger-menu span {
    width: 25px;
    height: 3px;
    background-color: #333;
    margin: 3px 0;
    transition: 0.3s;
    border-radius: 3px;
  }

  .hamburger-menu.active span:nth-child(1) {
    transform: rotate(-45deg) translate(-5px, 6px);
  }

  .hamburger-menu.active span:nth-child(2) {
    opacity: 0;
  }

  .hamburger-menu.active span:nth-child(3) {
    transform: rotate(45deg) translate(-5px, -6px);
  }

  /* Mobile Menu Overlay */
  .mobile-menu-overlay {
    display: none;
    position: fixed;
    top: 0;
    right: -100%;
    width: 280px;
    height: 100vh;
    background-color: white;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    transition: right 0.3s ease;
    overflow-y: auto;
  }

  .mobile-menu-overlay.active {
    right: 0;
  }

  .mobile-menu-header {
    padding: 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .mobile-menu-close {
    font-size: 28px;
    cursor: pointer;
    background: none;
    border: none;
    color: #333;
    padding: 0;
    line-height: 1;
  }

  .mobile-menu-items {
    padding: 20px;
  }

  .mobile-menu-items a {
    display: block;
    padding: 15px 0;
    text-decoration: none;
    color: #333;
    font-size: 16px;
    border-bottom: 1px solid #f0f0f0;
    transition: color 0.2s;
  }

  .mobile-menu-items a:hover {
    color: #fe424d;
  }

  /* Mobile Backdrop */
  .mobile-backdrop {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 999;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .mobile-backdrop.active {
    opacity: 1;
  }

  /* Mobile Specific Styles */
  @media (max-width: 991px) {
    .navbar-collapse {
      display: flex !important;
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
      flex-wrap: nowrap;
    }

    /* Left: Compass Icon + Explore */
    .navbar-brand {
      font-size: 24px;
      margin-right: 10px;
    }

    .navbar-nav:first-child {
      display: flex !important;
      flex-direction: row;
      margin: 0;
    }

    .navbar-nav:first-child .nav-link {
      padding: 0.5rem;
      font-weight: 500;
    }

    /* Center: Search Form */
    .navbar-nav:nth-child(2) {
      flex: 1;
      display: flex !important;
      justify-content: center;
      margin: 0 10px;
    }

    .navbar-nav:nth-child(2) form {
      width: 100%;
      max-width: 400px;
    }

    .search-input {
      font-size: 0.8rem;
      padding: 0.4rem 0.8rem;
    }

    .search-btn {
      padding: 0.4rem 0.8rem;
      font-size: 0.85rem;
    }

    .search-btn i {
      margin-right: 0.3rem;
    }

    /* Hide right navigation items on mobile */
    .navbar-nav:nth-child(3) {
      display: none !important;
    }

    /* Show hamburger menu */
    .hamburger-menu {
      display: flex;
    }

    .mobile-menu-overlay,
    .mobile-backdrop {
      display: block;
    }

    /* Hide default toggler */
    .navbar-toggler {
      display: none;
    }
  }

  /* Desktop: Keep original layout */
  @media (min-width: 992px) {
    .hamburger-menu,
    .mobile-menu-overlay,
    .mobile-backdrop {
      display: none !important;
    }
  }
</style>

<nav class="navbar navbar-expand-lg bg-body-light border-bottom sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="/listings"><i class="fa-regular fa-compass"></i></a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <!-- Explore Link -->
      <div class="navbar-nav">
        <a class="nav-link" href="/listings">Explore</a>
      </div>
      
      <!-- Search Form -->
      <div class="navbar-nav ms-auto">
        <form class="d-flex" role="search" id="searchForm">
          <input class="form-control me-2 search-input" type="search" placeholder="Search destinations" id="searchInput" name="query"/>
          <button class="btn search-btn" type="submit"><i class="fa-solid fa-magnifying-glass"></i>Search</button>
        </form>
      </div>
      
      <!-- Desktop Navigation Links -->
      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="/listings/new">Wanderlust your home</a>
        <% if(currUser) { %>
          <a class="nav-link" href="/bookings">My Bookings</a>
        <% } %>
        <% if(!currUser) { %>
          <a class="nav-link active" href="/signup"><b>SignUp</b></a>
          <a class="nav-link" href="/login"><b>LogIn</b></a>
        <% } %>
        <% if(currUser) { %>
          <a class="nav-link" href="/logout"><b>Logout</b></a>
        <% } %>
      </div>
      
      <!-- Hamburger Menu (Mobile Only) -->
      <button class="hamburger-menu" id="hamburgerMenu" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</nav>

<!-- Mobile Menu Backdrop -->
<div class="mobile-backdrop" id="mobileBackdrop"></div>

<!-- Mobile Menu Overlay -->
<div class="mobile-menu-overlay" id="mobileMenu">
  <div class="mobile-menu-header">
    <h5>Menu</h5>
    <button class="mobile-menu-close" id="closeMenu" aria-label="Close menu">&times;</button>
  </div>
  <div class="mobile-menu-items">
    <a href="/listings/new">Wanderlust your home</a>
    <% if(currUser) { %>
      <a href="/bookings">My Bookings</a>
      <a href="/logout"><b>Logout</b></a>
    <% } else { %>
      <a href="/signup"><b>SignUp</b></a>
      <a href="/login"><b>LogIn</b></a>
    <% } %>
  </div>
</div>

<script>
  // Hamburger Menu Functionality
  document.addEventListener('DOMContentLoaded', function() {
    const hamburgerMenu = document.getElementById('hamburgerMenu');
    const mobileMenu = document.getElementById('mobileMenu');
    const mobileBackdrop = document.getElementById('mobileBackdrop');
    const closeMenu = document.getElementById('closeMenu');

    if (hamburgerMenu && mobileMenu && mobileBackdrop && closeMenu) {
      // Open menu
      hamburgerMenu.addEventListener('click', function() {
        hamburgerMenu.classList.add('active');
        mobileMenu.classList.add('active');
        mobileBackdrop.classList.add('active');
        document.body.style.overflow = 'hidden';
      });

      // Close menu function
      function closeMenuHandler() {
        hamburgerMenu.classList.remove('active');
        mobileMenu.classList.remove('active');
        mobileBackdrop.classList.remove('active');
        document.body.style.overflow = '';
      }

      closeMenu.addEventListener('click', closeMenuHandler);
      mobileBackdrop.addEventListener('click', closeMenuHandler);
    }
  });

  // Search functionality
  const searchForm = document.getElementById('searchForm');
  const searchInput = document.getElementById('searchInput');

  searchForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const query = searchInput.value.trim();
    
    if (!query) {
      window.location.href = '/listings';
      return;
    }

    try {
      const response = await fetch(`/listings/search?query=${encodeURIComponent(query)}`);
      const data = await response.json();
      
      if (data.success) {
        if (window.location.pathname === '/listings') {
          displaySearchResults(data.listings);
        } else {
          sessionStorage.setItem('searchResults', JSON.stringify(data.listings));
          window.location.href = '/listings';
        }
      }
    } catch (error) {
      console.error('Search error:', error);
      alert('Search failed. Please try again.');
    }
  });

  function displaySearchResults(listings) {
    const container = document.getElementById('listings-container');
    
    if (!container) return;

    if (listings.length === 0) {
      container.innerHTML = `
        <div class="col-12 text-center mt-5">
          <h4>No listings found for "${searchInput.value}"</h4>
          <a href="/listings" class="btn btn-primary mt-3">View All Listings</a>
        </div>
      `;
      return;
    }

    const taxSwitch = document.getElementById('switchCheckDefault');
    container.innerHTML = listings.map(listing => `
      <a href="/listings/${listing._id}" class="listing-link">
        <div class="card col listing-card">
          <img src="${listing.image.url}" class="card-img-top" alt="listing_image" style="height: 20rem">
          <div class="card-img-overlay"></div>
          <div class="card-body">
            <p class="card-text">
              <b>${listing.title}</b><br>
              &#8377;${listing.price.toLocaleString("en-IN")} /night
              <i class="tax-info" style="display: ${taxSwitch && taxSwitch.checked ? 'none' : 'inline'}"> &nbsp;+ 18% GST</i>
            </p>
          </div>
        </div>
      </a>
    `).join('');
  }

  window.addEventListener('DOMContentLoaded', () => {
    const searchResults = sessionStorage.getItem('searchResults');
    if (searchResults && window.location.pathname === '/listings') {
      const listings = JSON.parse(searchResults);
      displaySearchResults(listings);
      sessionStorage.removeItem('searchResults');
    }
  });
</script>
